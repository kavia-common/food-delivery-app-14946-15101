{"is_source_file": true, "format": "Python", "description": "Source code for a FastAPI-based Payment Service API. It provides endpoints to create payment intents, retrieve payment status, simulate webhooks to update payment status, and a health check endpoint. It manages in-memory storage for payment intents and defines relevant data models, enums, and route handlers.", "external_files": ["fastapi", "pydantic", "datetime", "uuid", "typing"], "external_methods": ["fastapi.FastAPI", "fastapi.HTTPException", "fastapi.Body", "pydantic.BaseModel", "pydantic.Field", "datetime.datetime", "uuid.uuid4", "datetime.datetime.now"], "published": ["create_payment_intent", "get_payment", "payment_webhook"], "classes": [{"name": "CreatePaymentIntentRequest", "description": "Request model for creating a payment intent."}, {"name": "PaymentIntent", "description": "Response model representing a payment intent with details such as amount, status, and timestamps."}, {"name": "WebhookEvent", "description": "Model for simulating webhook events from external payment gateway."}], "methods": [{"name": "datetime _now()", "description": "Utility function to get current UTC datetime.", "scope": "", "scopeKind": ""}, {"name": "float _default_amount()", "description": "Function returning a default mock amount for payment intents.", "scope": "", "scopeKind": ""}, {"name": "create_payment_intent(payload: CreatePaymentIntentRequest)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_payment(paymentId: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "health()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "payment_webhook(event: WebhookEvent)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["uuid.uuid4", "datetime.now"], "search-terms": ["FastAPI payment endpoints", "Webhook event handling", "Payment intent creation", "In-memory payment store", "Payment status updates"], "state": 2, "file_id": 3, "knowledge_revision": 7, "git_revision": "", "ctags": [{"_type": "tag", "name": "CANCELLED", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    CANCELLED = \"cancelled\"$/", "language": "Python", "kind": "variable", "scope": "PaymentStatus", "scopeKind": "class"}, {"_type": "tag", "name": "CARD", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    CARD = \"card\"$/", "language": "Python", "kind": "variable", "scope": "PaymentMethod", "scopeKind": "class"}, {"_type": "tag", "name": "COD", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    COD = \"cod\"$/", "language": "Python", "kind": "variable", "scope": "PaymentMethod", "scopeKind": "class"}, {"_type": "tag", "name": "CreatePaymentIntentRequest", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^class CreatePaymentIntentRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "FAILED", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    FAILED = \"failed\"$/", "language": "Python", "kind": "variable", "scope": "PaymentStatus", "scopeKind": "class"}, {"_type": "tag", "name": "PAYMENT_STORE", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^PAYMENT_STORE: Dict[str, Dict] = {}$/", "language": "Python", "typeref": "typename:Dict[str, Dict]", "kind": "variable"}, {"_type": "tag", "name": "PROCESSING", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    PROCESSING = \"processing\"$/", "language": "Python", "kind": "variable", "scope": "PaymentStatus", "scopeKind": "class"}, {"_type": "tag", "name": "PaymentIntent", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^class PaymentIntent(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "PaymentMethod", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^class PaymentMethod(str):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "PaymentStatus", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^class PaymentStatus(str):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "REFUNDED", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    REFUNDED = \"refunded\"$/", "language": "Python", "kind": "variable", "scope": "PaymentStatus", "scopeKind": "class"}, {"_type": "tag", "name": "REQUIRES_CONFIRMATION", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    REQUIRES_CONFIRMATION = \"requires_confirmation\"$/", "language": "Python", "kind": "variable", "scope": "PaymentStatus", "scopeKind": "class"}, {"_type": "tag", "name": "REQUIRES_PAYMENT_METHOD", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    REQUIRES_PAYMENT_METHOD = \"requires_payment_method\"$/", "language": "Python", "kind": "variable", "scope": "PaymentStatus", "scopeKind": "class"}, {"_type": "tag", "name": "SUCCEEDED", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    SUCCEEDED = \"succeeded\"$/", "language": "Python", "kind": "variable", "scope": "PaymentStatus", "scopeKind": "class"}, {"_type": "tag", "name": "UPI", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    UPI = \"upi\"$/", "language": "Python", "kind": "variable", "scope": "PaymentMethod", "scopeKind": "class"}, {"_type": "tag", "name": "WALLET", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    WALLET = \"wallet\"$/", "language": "Python", "kind": "variable", "scope": "PaymentMethod", "scopeKind": "class"}, {"_type": "tag", "name": "WebhookEvent", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^class WebhookEvent(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_default_amount", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^def _default_amount() -> float:$/", "language": "Python", "typeref": "typename:float", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_now", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^def _now() -> datetime:$/", "language": "Python", "typeref": "typename:datetime", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "amount", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    amount: Optional[float] = Field( # Not in spec required, but useful for MVP$/", "language": "Python", "typeref": "typename:Optional[float]", "kind": "variable", "scope": "CreatePaymentIntentRequest", "scopeKind": "class"}, {"_type": "tag", "name": "amount", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    amount: float = Field(..., description=\"Order amount\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "PaymentIntent", "scopeKind": "class"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "clientSecret", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    clientSecret: Optional[str] = Field(None, description=\"Client secret for client-side SDKs\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "PaymentIntent", "scopeKind": "class"}, {"_type": "tag", "name": "create_payment_intent", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^def create_payment_intent(payload: CreatePaymentIntentRequest):$/", "language": "Python", "kind": "function", "signature": "(payload: CreatePaymentIntentRequest)"}, {"_type": "tag", "name": "createdAt", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    createdAt: datetime = Field(..., description=\"Creation timestamp\")$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "PaymentIntent", "scopeKind": "class"}, {"_type": "tag", "name": "currency", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    currency: Optional[str] = Field($/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "CreatePaymentIntentRequest", "scopeKind": "class"}, {"_type": "tag", "name": "currency", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    currency: str = Field(..., description=\"Currency code\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "PaymentIntent", "scopeKind": "class"}, {"_type": "tag", "name": "get_payment", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^def get_payment(paymentId: str):$/", "language": "Python", "kind": "function", "signature": "(paymentId: str)"}, {"_type": "tag", "name": "health", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^def health():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    id: str = Field(..., description=\"Payment intent ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "PaymentIntent", "scopeKind": "class"}, {"_type": "tag", "name": "metadata", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    metadata: Optional[dict] = Field(None, description=\"Additional details if any\")$/", "language": "Python", "typeref": "typename:Optional[dict]", "kind": "variable", "scope": "WebhookEvent", "scopeKind": "class"}, {"_type": "tag", "name": "method", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    method: Literal[\"card\", \"wallet\", \"upi\", \"cod\"] = Field($/", "language": "Python", "typeref": "typename:Literal[\"card\", \"wallet\", \"upi\", \"cod\"]", "kind": "variable", "scope": "CreatePaymentIntentRequest", "scopeKind": "class"}, {"_type": "tag", "name": "orderId", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    orderId: Optional[str] = Field(None, description=\"Associated order ID (optional mirror)\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "WebhookEvent", "scopeKind": "class"}, {"_type": "tag", "name": "orderId", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    orderId: str = Field(..., description=\"Associated order ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "CreatePaymentIntentRequest", "scopeKind": "class"}, {"_type": "tag", "name": "orderId", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    orderId: str = Field(..., description=\"Associated order ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "PaymentIntent", "scopeKind": "class"}, {"_type": "tag", "name": "paymentId", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    paymentId: str = Field(..., description=\"Target payment ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "WebhookEvent", "scopeKind": "class"}, {"_type": "tag", "name": "payment_webhook", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^def payment_webhook(event: WebhookEvent):$/", "language": "Python", "kind": "function", "signature": "(event: WebhookEvent)"}, {"_type": "tag", "name": "provider", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    provider: Optional[str] = Field(None, description=\"Mock provider name\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "PaymentIntent", "scopeKind": "class"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    status: Literal[$/", "language": "Python", "typeref": "typename:Literal[ \"requires_payment_method\", \"requires_confirmation\", \"processing\", \"succeeded\", \"failed\", \"cancelled\", \"refunded\", ]", "kind": "variable", "scope": "PaymentIntent", "scopeKind": "class"}, {"_type": "tag", "name": "type", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    type: Literal[$/", "language": "Python", "typeref": "typename:Literal[ \"payment_intent.succeeded\", \"payment_intent.failed\", \"payment_intent.processing\", \"payment_intent.canceled\", \"payment_intent.refunded\", ]", "kind": "variable", "scope": "WebhookEvent", "scopeKind": "class"}, {"_type": "tag", "name": "updatedAt", "path": "/home/kavia/workspace/code-generation/food-delivery-app-14946-15101/PaymentService/main.py", "pattern": "/^    updatedAt: datetime = Field(..., description=\"Last update timestamp\")$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "PaymentIntent", "scopeKind": "class"}], "hash": "e3c3e8e186abdbd71a2aa951b8c1b213", "format-version": 4, "code-base-name": "PaymentService", "filename": "PaymentService/main.py", "fields": [{"name": "CANCELLED = \"cancelled\"", "scope": "PaymentStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "CARD = \"card\"", "scope": "PaymentMethod", "scopeKind": "class", "description": "unavailable"}, {"name": "COD = \"cod\"", "scope": "PaymentMethod", "scopeKind": "class", "description": "unavailable"}, {"name": "FAILED = \"failed\"", "scope": "PaymentStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, Dict] PAYMENT_STORE", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "PROCESSING = \"processing\"", "scope": "PaymentStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "REFUNDED = \"refunded\"", "scope": "PaymentStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "REQUIRES_CONFIRMATION = \"requires_confirmation\"", "scope": "PaymentStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "REQUIRES_PAYMENT_METHOD = \"requires_payment_method\"", "scope": "PaymentStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "SUCCEEDED = \"succeeded\"", "scope": "PaymentStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "UPI = \"upi\"", "scope": "PaymentMethod", "scopeKind": "class", "description": "unavailable"}, {"name": "WALLET = \"wallet\"", "scope": "PaymentMethod", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[float] amount", "scope": "CreatePaymentIntentRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "float amount", "scope": "PaymentIntent", "scopeKind": "class", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] clientSecret", "scope": "PaymentIntent", "scopeKind": "class", "description": "unavailable"}, {"name": "datetime createdAt", "scope": "PaymentIntent", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] currency", "scope": "CreatePaymentIntentRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str currency", "scope": "PaymentIntent", "scopeKind": "class", "description": "unavailable"}, {"name": "str id", "scope": "PaymentIntent", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[dict] metadata", "scope": "WebhookEvent", "scopeKind": "class", "description": "unavailable"}, {"name": "Literal[\"card\", \"wallet\", \"upi\", \"cod\"] method", "scope": "CreatePaymentIntentRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] orderId", "scope": "WebhookEvent", "scopeKind": "class", "description": "unavailable"}, {"name": "str orderId", "scope": "CreatePaymentIntentRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str paymentId", "scope": "WebhookEvent", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] provider", "scope": "PaymentIntent", "scopeKind": "class", "description": "unavailable"}, {"name": "Literal[ \"requires_payment_method\", \"requires_confirmation\", \"processing\", \"succeeded\", \"failed\", \"cancelled\", \"refunded\", ] status", "scope": "PaymentIntent", "scopeKind": "class", "description": "unavailable"}, {"name": "Literal[ \"payment_intent.succeeded\", \"payment_intent.failed\", \"payment_intent.processing\", \"payment_intent.canceled\", \"payment_intent.refunded\", ] type", "scope": "WebhookEvent", "scopeKind": "class", "description": "unavailable"}, {"name": "datetime updatedAt", "scope": "PaymentIntent", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"7": ""}]}